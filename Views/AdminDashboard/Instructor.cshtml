@model AP_Project.Models.Users.Admin
@{
  ViewData["Title"] = "داشبورد ادمین";
  Layout = "_LayoutAdmin";
  ViewData["ActiveTab"] = "Instructor";
  var instructors = ViewBag.Instructors as List<AP_Project.Models.Users.Instructor>;
  var hasFooter = false;
}

<!-- استایل اختصاصی این صفحه -->
<link rel="stylesheet" href="~/css/AdminDashboard/instructor-management.css" asp-append-version="true" />


<main class="admin-main @(hasFooter ? "has-footer" : "has-not-footer")">
  <div class="toolbar">
    <button class="btn-add-instructor">
      <span class="icon">&#43;</span>
      <span class="text">افزودن استاد</span>
    </button>
  </div>

  @if (instructors != null && instructors.Any())
  {
    <table class="instructor-table">
      <thead>
        <tr>
          <th class="col-index">ردیف</th>
          <th class="col-truncate">نام</th>
          <th class="col-truncate">نام خانوادگی</th>
          <th class="col-truncate">ایمیل</th>
          <th class="col-fixed">سال استخدام</th>
          <th class="col-fixed">حقوق (تومان)</th>
          <th class="col-fixed">کد مدرسی</th>
          <th class="col-userid">آی‌دی کاربری</th>
          <th class="col-actions"></th>
        </tr>
      </thead>
      <tbody>
      @for (int i = 0; i < instructors.Count; i++)
      {
        var inst = instructors[i];
        var userId = inst.Id.ToString();
        <tr>
          <td class="col-index">@((i + 1))</td>
          <td class="col-fname">@inst.FirstName</td>
          <td class="col-lname">@inst.LastName</td>
          <td class="col-email">@inst.Email</td>
          <td class="col-fixed">@inst.HireYear</td>
          <td class="col-fixed">@String.Format("{0:N0}", inst.Salary)</td>
          <td class="col-fixed">@inst.InstructorId</td>
          <td class="col-userid">
            <button class="copy-id-button" data-id="@userId" data-tooltip="@userId" data-tooltip-align="center">کپی</button>
          </td>
          <td class="col-actions">
            <div class="actions-wrapper">
              <button class="btn-action btn-edit" data-tooltip="ویرایش" data-tooltip-align="center"><i class="icon-edit"></i></button>
              <button class="btn-action btn-delete" data-tooltip="حذف" data-tooltip-align="center"><i class="icon-delete"></i></button>
            </div>
          </td>
        </tr>
      }
      </tbody>
    </table>
  }
  else
  {
    <div class="empty-popup">
      <p>موردی جهت نمایش وجود ندارد</p>
    </div>
  }
</main>

@if (hasFooter)
{
  <footer class="admin-footer">
    <p>متن فوتر</p>
  </footer>
}

<script>
  // تول‌تیپ
  const tooltip = document.createElement('div');
  tooltip.className = 'custom-tooltip';
  document.body.appendChild(tooltip);

  document.querySelectorAll('[data-tooltip]').forEach(el => {
    el.addEventListener('mouseenter', () => {
      const text = el.getAttribute('data-tooltip');
      const align = el.getAttribute('data-tooltip-align') || 'center';
      tooltip.textContent = text;

      tooltip.textContent = text;
      tooltip.classList.remove('align-left','align-center','align-right','show');
      tooltip.classList.add(`align-${align}`, 'show');

      const r = el.getBoundingClientRect();
      tooltip.style.top = (r.bottom + 6) + 'px';
      if (align === 'left') {
        tooltip.style.left = r.left + 'px';
      } else if (align === 'right') {
        tooltip.style.left = r.right + 'px';
      } else { // center
        tooltip.style.left = (r.left + r.width/2) + 'px';
      }
    });

    el.addEventListener('mouseleave', () => {
      tooltip.classList.remove('show');
    });
  });

  // دکمه‌های کپی
  document.querySelectorAll('.copy-id-button').forEach(btn => {
    btn.addEventListener('click', () => {
      const id = btn.getAttribute('data-id');
      navigator.clipboard.writeText(id).then(() => {
        tooltip.textContent = 'کپی شد';
        tooltip.classList.remove('align-left','align-center','align-right','show');
        tooltip.classList.add('align-center', 'show');

        const r = btn.getBoundingClientRect();
        tooltip.style.top  = (r.bottom + 6) + 'px';
        tooltip.style.left = (r.left + r.width/2) + 'px';
      });
    });
  });
</script>
